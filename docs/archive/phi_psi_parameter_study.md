# φ, ψパラメータスタディ結果

## テスト結果まとめ

| φ, ψ値 | 降伏条件 | 失敗するStep | ||Rg||の挙動 |
|---------|----------|--------------|-------------|
| 10°, 10° | Drucker-Prager | Step 13 | 10.569 → 2369.9 (爆発) |
| 0.001°, 0.001° | ほぼVon Mises | Step 11 | 15.675 → 4317.6 (爆発) |
| 0°, 0° | 完全Von Mises | Step 11 | 15.687 → 4317.7 (爆発) |

## 重要な発見

### 1. 問題はDrucker-Prager固有ではない
- φ=ψ=0（Von Mises）でも同じ発散パターン
- 圧力依存性（η, ξ項）を除去しても解決しない
- **問題の本質は材料モデルではなく、アルゴリズムの欠陥**

### 2. 失敗タイミングの変化
- φ=10°: Step 13で失敗（dfact=0.13）
- φ=0°: Step 11で失敗（dfact=0.11）
- φ減少により若干早く降伏するが、本質的な問題は同じ

### 3. 発散パターンは共通
すべてのケースで同じ挙動：
```
反復1: ||Rg|| ≈ 10-15（初期降伏違反）
反復2: ||Rg|| ≈ 4000+（爆発！）
反復3: PCGソルバー失敗（error 24）
```

## 結論

**φ, ψ ≈ 0にしても問題は解決しない**

理由：
1. Block Newton実装の根本的欠陥は材料モデルに依存しない
2. 弾塑性遷移時のNewton更新の不安定性が本質的問題
3. Von Misesモデルでも同じ発散を示す

## 数学的解釈

φ=ψ=0の場合、Drucker-Prager降伏関数は：
```
f = √(J₂/2) - ξσ_Y
```
となり、純粋なVon Mises型。

しかし、Block Newton法の問題：
```
Δγ = -(M:ε + g) / N
```
のN（分母）が小さくなると、Δγが爆発する構造は変わらない。

## 推奨事項

材料パラメータ調整では解決不可能。必要なのは：

1. **アルゴリズム修正**
   - Line searchまたはダンピング機構の追加
   - Δγの上限設定
   - 収束判定の改善

2. **代替手法への切り替え**
   - Return Mapping法（stress_dp_rm.f）の使用
   - すでに全パラメータ範囲で動作確認済み

## 追加実験案

もし継続調査するなら：
- 硬化パラメータ（hk, hpa）の調整
- 初期降伏応力（σ_Y）の増加
- 荷重ステップ（df）の細分化

ただし、根本解決にはならない可能性が高い。