# von Mises Block Newton法実装ノート

## 概要
`stress_vm_bn.f`における von Mises塑性モデルのBlock Newton法実装について、山本ら(2021)の論文のBOX1,2形式でまとめた。

## TeXファイル
- `von_mises_block_newton_algorithm.tex`: アルゴリズムの詳細をBOX形式で記述
- `compile_tex.sh`: PDFコンパイル用スクリプト

## 実装のポイント

### BOX 1: 主要アルゴリズム
1. **試行応力の計算**: 弾性予測子による応力計算
2. **塑性判定**: 降伏関数による弾塑性判定
3. **整合パラメータ更新**: グローバル反復からのδγを用いてΔγを更新
4. **状態変数更新**: 塑性ひずみ、相当塑性ひずみ、背応力の更新
5. **応力と降伏関数の計算**: 更新された変数での応力と降伏関数値g
6. **接線剛性の計算**: L, M, N行列を用いた弾塑性接線剛性

### BOX 2: 初期化（k=0）
1. **Δγ(0) = 0で初期化**
2. **弾性応力の計算**: σ(0) = s^tr + κtr(ε)I
3. **初期降伏関数の評価**: g(0)の計算（Δγ=0での応力で）
4. **塑性変数の初期設定**: 前ステップの値を使用
5. **流動方向の計算**: n(0) = ξ(0)/||ξ(0)||
6. **接線計算用行列の初期化**: L(0), M(0), N(0)

## Return Mappingとの主な違い

| 項目 | Return Mapping | Block Newton |
|------|---------------|--------------|
| 局所反復 | あり（収束まで反復） | なし（グローバル反復のみ） |
| 降伏条件 | 局所で満足させる | グローバルで同時に満足 |
| 計算効率 | 局所反復が多い | 2-3回のグローバル反復で収束 |
| 実装複雑度 | 比較的単純 | グローバル連成が必要 |

## 重要な修正点（2次収束達成のため）

1. **初回反復での降伏関数g_valの正確な計算**
   - Δγ=0での応力から計算（試行応力値をそのまま使わない）

2. **背応力βの非累積的更新**
   - 各反復で前ステップからの完全再計算

3. **流動方向nの適切な更新**
   - 初回反復でもΔγ=0での相対応力から計算

## 収束性
適切に実装された場合、Block Newton法は2次収束を示し、通常2-3回の反復で収束する。